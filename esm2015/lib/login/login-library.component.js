import { Component, EventEmitter, Inject, Output } from '@angular/core';
import { FormControl, Validators } from '@angular/forms';
import { CONFIGLIBRARY } from '../../config-library.interface';
import * as i0 from "@angular/core";
import * as i1 from "@angular/forms";
import * as i2 from "./services/auth.service";
import * as i3 from "./services/auth-AD.service";
import * as i4 from "./interfaces/token-payload-provider.interface";
import * as i5 from "@azure/msal-angular";
import * as i6 from "@angular/material/form-field";
import * as i7 from "@angular/material/icon";
import * as i8 from "@angular/material/button";
import * as i9 from "@angular/common";
import * as i10 from "@angular/material/input";
import * as i11 from "../../config-library.interface";
export class LoginLibraryComponent {
    constructor(configLibrary, fb, authService, authServiceAD, tokenPorviderService, msalService) {
        this.fb = fb;
        this.authService = authService;
        this.authServiceAD = authServiceAD;
        this.tokenPorviderService = tokenPorviderService;
        this.msalService = msalService;
        this.loginClick = new EventEmitter();
        this.resetClick = new EventEmitter();
        this.isAuthenticated = false;
        this.typeLogin = '';
        this.isAd = false;
        this.tokenAd = '';
        this.typeLogin = configLibrary.loginType;
    }
    ngOnInit() {
        this.loadForm();
        this.typeLogin = this.authService.loginType;
    }
    loadForm() {
        this.loginForm = this.fb.group({
            userName: new FormControl(null, [Validators.required, Validators.maxLength(50)]),
            password: new FormControl(null, [Validators.required, Validators.maxLength(50)]),
        });
    }
    login() {
        if (this.loginForm.invalid) {
            this.loginClick.emit(false);
        }
        else {
            this.authUser();
        }
    }
    authUser() {
        this.authService.login(this.loginForm.value).subscribe(response => {
            if (response) {
                this.tokenPorviderService.setToken(response);
                this.loginClick.emit(true);
            }
            else {
                this.loginClick.emit(false);
            }
        }, error => {
            console.log(error);
            this.loginClick.emit(false);
        });
    }
    loginAD() {
        this.isAd = true;
        this.msalService.loginPopup().subscribe((response) => {
            this.msalService.instance.setActiveAccount(response.account);
            this.tokenAd = response.accessToken;
            this.authUserAD(this.tokenAd);
        }, error => {
            console.log('Error: ', error);
            this.loginClick.emit(false);
        });
    }
    authUserAD(token) {
        this.authServiceAD.loginAD(token).subscribe(response => {
            if (response) {
                this.tokenPorviderService.setToken(response);
                this.loginClick.emit(true);
            }
            else {
                this.loginClick.emit(false);
            }
        }, error => {
            console.log(error);
            this.loginClick.emit(false);
        });
    }
    recoveryPassEmit() {
        this.resetClick.emit(true);
    }
}
LoginLibraryComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: LoginLibraryComponent, deps: [{ token: CONFIGLIBRARY }, { token: i1.FormBuilder }, { token: i2.AuthenticationService }, { token: i3.AuthAdService }, { token: i4.TokenPorviderService }, { token: i5.MsalService }], target: i0.ɵɵFactoryTarget.Component });
LoginLibraryComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "12.2.16", type: LoginLibraryComponent, selector: "lib-security-library-login", outputs: { loginClick: "loginClick", resetClick: "resetClick" }, ngImport: i0, template: "<div class=\"container\">\r\n  <div class=\"row form-content justify-content-start align-items-center\">\r\n    <form [formGroup]=\"loginForm\" >\r\n      <div class=\"col col-xl-4 col-lg-8 col-md-8 col-12\">\r\n        <div class=\"container-fluid\">\r\n          <div *ngIf=\"typeLogin !== 'internal'\" class=\"row\">\r\n            <div class=\"col col-12\">\r\n              <mat-label>Correo\r\n              </mat-label>\r\n              <mat-form-field [style.fontSize.px]=\"12\" appearance=\"outline\">\r\n                <mat-label>ejemplo@corrreo.com\r\n                </mat-label>\r\n                <mat-icon matSuffix>email</mat-icon>\r\n                <input \r\n                  matInput \r\n                  type=\"text\" \r\n                  placeholder=\"ejemplo@corrreo.com\" \r\n                  maxlength=\"50\" \r\n                  formControlName=\"userName\" \r\n                  name=\"userName\" \r\n                  id=\"userName\" \r\n                  required>\r\n                  \r\n                <mat-error *ngIf=\"loginForm.get('userName')?.hasError('required') && loginForm.get('userName')?.touched\">\r\n                  Campo requerido\r\n                </mat-error>\r\n              </mat-form-field>\r\n            </div>\r\n            <div class=\"col col-12\">\r\n              <mat-label>Contrase\u00F1a</mat-label>\r\n              <mat-form-field [style.fontSize.px]=\"12\" appearance=\"outline\">\r\n                <mat-label>contrase\u00F1a</mat-label>\r\n                <mat-icon matSuffix>vpn_key</mat-icon>\r\n                <input \r\n                  matInput \r\n                  type=\"password\" \r\n                  placeholder=\"Contrase\u00F1a\" \r\n                  maxlength=\"50\" \r\n                  formControlName=\"password\" \r\n                  name=\"password\" \r\n                  id=\"passwor\" \r\n                  required>\r\n                <mat-error *ngIf=\"loginForm.get('password')?.hasError('required') && loginForm.get('password')?.touched\">\r\n                  Campo requerido\r\n                </mat-error>\r\n              </mat-form-field>\r\n            </div>\r\n            <div class=\"row recovery-pass\">\r\n              <div class=\"col col-12\">\r\n                <button mat-button class=\"btn_tertiary\" (click)=\"recoveryPassEmit()\">Olvide mi contrase\u00F1a</button>\r\n              </div>\r\n            </div>\r\n            <div class=\"col col-12 text-center\">\r\n              <button class=\"btn_primary\" (click)=\"login()\">Iniciar sesi\u00F3n</button>\r\n            </div> \r\n          </div>\r\n          <div *ngIf=\"typeLogin !== 'external'\" class=\"col col-12 text-center\">\r\n            <button mat-button class=\"btn_tertiary\" (click)=\"loginAD()\">Ingresar con Active Directory</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </form>   \r\n  </div>\r\n</div>", styles: [".btn_primary{color:#f8f9fb;text-transform:initial;text-align:center;background-color:#214eb7;text-decoration:none;border:0;border-radius:8px;cursor:pointer;letter-spacing:1.5px;width:100%!important;height:40px;padding:10px 8px;font-size:14px;font-weight:400}.btn_primary:hover{background-color:#01818f}.btn_primary:disabled{color:#828282;background-color:#b0b0b0;pointer-events:none}.btn_secondary{color:#01818f;text-transform:initial;text-align:center;background-color:#ecfafc;text-decoration:none;border:1px solid #0095A8;border-radius:8px;cursor:pointer;letter-spacing:1.5px;width:150px!important;height:40px;padding:10px 8px;font-size:14px;font-weight:400}.btn_secondary:hover{background-color:#b2eaf333}.btn_secondary:disabled{color:#b0b0b0;background-color:#e9e9e9;border:1px solid #e9e9e9;pointer-events:none}.btn_tertiary{color:#214eb7}.bg_breadcrumb{background:url(/assets/img/bg_breadcrumb.png) no-repeat;background-color:#005db4;background-size:contain;height:72px;padding-left:30px}.bg_breadcrumb .breadcrumb{color:#fff;margin:0;padding:0;font-style:normal;font-weight:600;letter-spacing:.02em;text-transform:capitalize;vertical-align:middle;line-height:58px}.bg_breadcrumb .breadcrumb span{font-size:18px;color:#bcd}.bg_breadcrumb .breadcrumb span:hover{color:#01818f;text-decoration:none}.bg_breadcrumb .breadcrumb li{list-style:none;float:left;margin:5px}.bg_breadcrumb .breadcrumb li:last-child{margin-right:5px}.bg_breadcrumb .breadcrumb li:after{content:\" > \";color:#fff}.bg_breadcrumb .breadcrumb li:last-child:after{content:\"\"}h1{font-size:34px;font-weight:500}h2{font-size:24px;font-weight:500}h3{font-size:20px;font-weight:500}h4{font-size:18px;font-weight:400}h5{font-style:normal!important;font-weight:500!important;font-size:12px!important;line-height:18px!important;letter-spacing:.15px!important;color:#3f4b6c!important}a{color:#118584}.swal2-styled.swal2-confirm{background-color:#0095a8!important}.swal2-styled.swal2-confirm:focus{box-shadow:none!important}.bg_evidence{background:rgba(249,249,249,.55);border:.5px solid #eceff2;box-sizing:border-box;height:261px;padding-left:25px;margin-left:25px;margin-right:25px}.date_evidence{font-style:normal;font-weight:500;font-size:12px;line-height:18px;text-align:center;letter-spacing:.155002px;color:#7792ac}.rb_evidence{display:flex;flex-direction:column;margin:15px 0;width:150px}.container_evidence{margin:4px,4px;padding:4px;overflow-x:auto;overflow-y:hidden;white-space:nowrap;width:100%}.card_evidence{width:170px;text-align:center}.lbl_evidence{font-style:normal;font-weight:500;font-size:12px;line-height:18px;letter-spacing:.15px;color:#3f4b6c}.mat-form-field-no-padding .mat-form-field-wrapper{margin-top:-.5em}.mobile-label{display:none}.mobile-cantidad>input{width:80%}@media (max-width: 600px){.mobile-label{width:130px;display:inline-block;font-weight:bold}.mat-header-row{display:none}.mat-row{flex-direction:column;align-items:start;text-align:left;padding:8px 24px}.mat-cell:first-of-type{padding:5px 10px!important}.mobile-cantidad{width:150px}}.container .form-content .title{font-family:var(--font-poppins-bold);font-style:normal;font-weight:500;font-size:26px;line-height:39px;text-transform:uppercase;color:#9399b2}.container mat-form-field.mat-form-field{width:100%;font-size:16px;color:#9399b2}.container mat-label{font-family:var(--font-roboto);font-style:normal;font-weight:700;font-size:14px;line-height:14px;letter-spacing:.15px;color:#656d8e}.text-center{display:grid}.recovery-pass{text-align:right}.login_title{font-family:\"Poppins\",\"Roboto\",sans-serif;font-style:normal;font-weight:500;font-size:26px;line-height:39px;text-transform:uppercase;color:#f8f9fb}.login_label{font-family:\"Roboto\",sans-serif;font-style:normal;font-weight:bold;font-size:12px;line-height:14px;letter-spacing:.15px;color:#f8f9fb}input::placeholder{font-family:\"Roboto\",sans-serif;font-style:normal;font-weight:500;font-size:14px;line-height:16px;letter-spacing:.15px;color:#9eb7cc}input:-webkit-autofill,input:-webkit-autofill:hover,input:-webkit-autofill:focus,input:-webkit-autofill:active{-webkit-transition:background-color 5000s;transition:background-color 5000s;-webkit-text-fill-color:#656D8E!important}\n"], components: [{ type: i6.MatFormField, selector: "mat-form-field", inputs: ["color", "floatLabel", "appearance", "hideRequiredMarker", "hintLabel"], exportAs: ["matFormField"] }, { type: i7.MatIcon, selector: "mat-icon", inputs: ["color", "inline", "svgIcon", "fontSet", "fontIcon"], exportAs: ["matIcon"] }, { type: i8.MatButton, selector: "button[mat-button], button[mat-raised-button], button[mat-icon-button],             button[mat-fab], button[mat-mini-fab], button[mat-stroked-button],             button[mat-flat-button]", inputs: ["disabled", "disableRipple", "color"], exportAs: ["matButton"] }], directives: [{ type: i1.ɵNgNoValidate, selector: "form:not([ngNoForm]):not([ngNativeValidate])" }, { type: i1.NgControlStatusGroup, selector: "[formGroupName],[formArrayName],[ngModelGroup],[formGroup],form:not([ngNoForm]),[ngForm]" }, { type: i1.FormGroupDirective, selector: "[formGroup]", inputs: ["formGroup"], outputs: ["ngSubmit"], exportAs: ["ngForm"] }, { type: i9.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { type: i6.MatLabel, selector: "mat-label" }, { type: i6.MatSuffix, selector: "[matSuffix]" }, { type: i10.MatInput, selector: "input[matInput], textarea[matInput], select[matNativeControl],      input[matNativeControl], textarea[matNativeControl]", inputs: ["id", "disabled", "required", "type", "value", "readonly", "placeholder", "errorStateMatcher", "aria-describedby"], exportAs: ["matInput"] }, { type: i1.DefaultValueAccessor, selector: "input:not([type=checkbox])[formControlName],textarea[formControlName],input:not([type=checkbox])[formControl],textarea[formControl],input:not([type=checkbox])[ngModel],textarea[ngModel],[ngDefaultControl]" }, { type: i1.MaxLengthValidator, selector: "[maxlength][formControlName],[maxlength][formControl],[maxlength][ngModel]", inputs: ["maxlength"] }, { type: i1.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { type: i1.FormControlName, selector: "[formControlName]", inputs: ["disabled", "formControlName", "ngModel"], outputs: ["ngModelChange"] }, { type: i1.RequiredValidator, selector: ":not([type=checkbox])[required][formControlName],:not([type=checkbox])[required][formControl],:not([type=checkbox])[required][ngModel]", inputs: ["required"] }, { type: i6.MatError, selector: "mat-error", inputs: ["id"] }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: LoginLibraryComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'lib-security-library-login',
                    templateUrl: './login-library.component.html',
                    styleUrls: ['./login-library.component.scss']
                }]
        }], ctorParameters: function () { return [{ type: i11.IConfigLibrary, decorators: [{
                    type: Inject,
                    args: [CONFIGLIBRARY]
                }] }, { type: i1.FormBuilder }, { type: i2.AuthenticationService }, { type: i3.AuthAdService }, { type: i4.TokenPorviderService }, { type: i5.MsalService }]; }, propDecorators: { loginClick: [{
                type: Output
            }], resetClick: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9naW4tbGlicmFyeS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9zZWN1cml0eS1saWJyYXJ5L3NyYy9saWIvbG9naW4vbG9naW4tbGlicmFyeS5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9zZWN1cml0eS1saWJyYXJ5L3NyYy9saWIvbG9naW4vbG9naW4tbGlicmFyeS5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLFlBQVksRUFBRSxNQUFNLEVBQVUsTUFBTSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ2hGLE9BQU8sRUFBZSxXQUFXLEVBQWEsVUFBVSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFPakYsT0FBTyxFQUFFLGFBQWEsRUFBa0IsTUFBTSxnQ0FBZ0MsQ0FBQzs7Ozs7Ozs7Ozs7OztBQU0vRSxNQUFNLE9BQU8scUJBQXFCO0lBVS9CLFlBQzBCLGFBQTZCLEVBQzVDLEVBQWUsRUFDZixXQUFrQyxFQUNsQyxhQUE0QixFQUM1QixvQkFBMEMsRUFDMUMsV0FBd0I7UUFKeEIsT0FBRSxHQUFGLEVBQUUsQ0FBYTtRQUNmLGdCQUFXLEdBQVgsV0FBVyxDQUF1QjtRQUNsQyxrQkFBYSxHQUFiLGFBQWEsQ0FBZTtRQUM1Qix5QkFBb0IsR0FBcEIsb0JBQW9CLENBQXNCO1FBQzFDLGdCQUFXLEdBQVgsV0FBVyxDQUFhO1FBZnpCLGVBQVUsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBQ2hDLGVBQVUsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBR25DLG9CQUFlLEdBQUcsS0FBSyxDQUFDO1FBQ3hCLGNBQVMsR0FBVyxFQUFFLENBQUM7UUFDOUIsU0FBSSxHQUFZLEtBQUssQ0FBQztRQUN0QixZQUFPLEdBQVcsRUFBRSxDQUFDO1FBVWxCLElBQUksQ0FBQyxTQUFTLEdBQUcsYUFBYSxDQUFD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QUssQ0FBQyxFQUFFO1lBQ0wsT0FBTyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQTtZQUNsQixJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQTtRQUM5QixDQUFDLENBQ0gsQ0FBQTtJQUNKLENBQUM7SUFFTSxnQkFBZ0I7UUFDcEIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDOUIsQ0FBQzs7bUhBNUZTLHFCQUFxQixrQkFXcEIsYUFBYTt1R0FYZCxxQkFBcUIsbUlDZGxDLHUzRkErRE07NEZEakRPLHFCQUFxQjtrQkFMakMsU0FBUzttQkFBQztvQkFDUixRQUFRLEVBQUUsNEJBQTRCO29CQUN0QyxXQUFXLEVBQUUsZ0NBQWdDO29CQUM3QyxTQUFTLEVBQUUsQ0FBQyxnQ0FBZ0MsQ0FBQztpQkFDL0M7OzBCQVlNLE1BQU07MkJBQUMsYUFBYTttTUFWZCxVQUFVO3NCQUFuQixNQUFNO2dCQUNHLFVBQVU7c0JBQW5CLE1BQU0iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIEV2ZW50RW1pdHRlciwgSW5qZWN0LCBPbkluaXQsIE91dHB1dCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBGb3JtQnVpbGRlciwgRm9ybUNvbnRyb2wsIEZvcm1Hcm91cCwgVmFsaWRhdG9ycyB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcclxuXHJcbmltcG9ydCB7IEF1dGhlbnRpY2F0aW9uU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvYXV0aC5zZXJ2aWNlJztcclxuaW1wb3J0IHsgVG9rZW5Qb3J2aWRlclNlcnZpY2UgfSBmcm9tICcuL2ludGVyZmFjZXMvdG9rZW4tcGF5bG9hZC1wcm92aWRlci5pbnRlcmZhY2UnO1xyXG5pbXBvcnQgeyBNc2FsU2VydmljZSB9IGZyb20gJ0BhenVyZS9tc2FsLWFuZ3VsYXInO1xyXG5pbXBvcnQgeyBBdXRoZW50aWNhdGlvblJlc3VsdCB9IGZyb20gJ0BhenVyZS9tc2FsLWJyb3dzZXInO1xyXG5pbXBvcnQgeyBBdXRoQWRTZXJ2aWNlIH0gZnJvbSAnLi9zZXJ2aWNlcy9hdXRoLUFELnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBDT05GSUdMSUJSQVJZLCBJQ29uZmlnTGlicmFyeSB9IGZyb20gJy4uLy4uL2NvbmZpZy1saWJyYXJ5LmludGVyZmFjZSc7XHJcbkBDb21wb25lbnQoe1xyXG4gICBzZWxlY3RvcjogJ2xpYi1zZWN1cml0eS1saWJyYXJ5LWxvZ2luJyxcclxuICAgdGVtcGxhdGVVcmw6ICcuL2xvZ2luLWxpYnJhcnkuY29tcG9uZW50Lmh0bWwnLFxyXG4gICBzdHlsZVVybHM6IFsnLi9sb2dpbi1saWJyYXJ5LmNvbXBvbmVudC5zY3NzJ11cclxufSlcclxuZXhwb3J0IGNsYXNzIExvZ2luTGlicmFyeUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcbiAgIEBPdXRwdXQoKSBsb2dpbkNsaWNrID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICBAT3V0cHV0KCkgcmVzZXRDbGljayA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgIHB1YmxpYyBsb2dpbkZvcm0hOiBGb3JtR3JvdXA7XHJcbiAgIHB1YmxpYyBpc0F1dGhlbnRpY2F0ZWQgPSBmYWxzZTtcclxuICAgcHVibGljIHR5cGVMb2dpbjogc3RyaW5nID0gJyc7XHJcbiAgIGlzQWQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgdG9rZW5BZDogc3RyaW5nID0gJyc7XHJcblxyXG4gICBjb25zdHJ1Y3RvcihcclxuICAgICAgQEluamVjdChDT05GSUdMSUJSQVJZKSBjb25maWdMaWJyYXJ5OiBJQ29uZmlnTGlicmFyeSxcclxuICAgICAgcHJpdmF0ZSBmYjogRm9ybUJ1aWxkZXIsXHJcbiAgICAgIHByaXZhdGUgYXV0aFNlcnZpY2U6IEF1dGhlbnRpY2F0aW9uU2VydmljZSxcclxuICAgICAgcHJpdmF0ZSBhdXRoU2VydmljZUFEOiBBdXRoQWRTZXJ2aWNlLFxyXG4gICAgICBwcml2YXRlIHRva2VuUG9ydmlkZXJTZXJ2aWNlOiBUb2tlblBvcnZpZGVyU2VydmljZSxcclxuICAgICAgcHJpdmF0ZSBtc2FsU2VydmljZTogTXNhbFNlcnZpY2UsXHJcbiAgICkge1xyXG4gICAgICB0aGlzLnR5cGVMb2dpbiA9IGNvbmZpZ0xpYnJhcnkubG9naW5UeXBlO1xyXG4gICAgfVxyXG5cclxuICAgcHVibGljIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgICB0aGlzLmxvYWRGb3JtKCk7XHJcbiAgICAgIHRoaXMudHlwZUxvZ2luID0gdGhpcy5hdXRoU2VydmljZS5sb2dpblR5cGU7XHJcbiAgIH1cclxuXHJcbiAgIHByaXZhdGUgbG9hZEZvcm0oKSB7XHJcbiAgICAgIHRoaXMubG9naW5Gb3JtID0gdGhpcy5mYi5ncm91cCh7XHJcbiAgICAgICAgIHVzZXJOYW1lOiBuZXcgRm9ybUNvbnRyb2wobnVsbCwgW1ZhbGlkYXRvcnMucmVxdWlyZWQsIFZhbGlkYXRvcnMubWF4TGVuZ3RoKDUwKV0pLFxyXG4gICAgICAgICBwYXNzd29yZDogbmV3IEZvcm1Db250cm9sKG51bGwsIFtWYWxpZGF0b3JzLnJlcXVpcmVkLCBWYWxpZGF0b3JzLm1heExlbmd0aCg1MCldKSxcclxuICAgICAgfSlcclxuICAgfVxyXG5cclxuICAgcHVibGljIGxvZ2luKCkge1xyXG4gICAgICBpZiAodGhpcy5sb2dpbkZvcm0uaW52YWxpZCkge1xyXG4gICAgICAgICB0aGlzLmxvZ2luQ2xpY2suZW1pdChmYWxzZSlcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgdGhpcy5hdXRoVXNlcigpO1xyXG4gICAgICB9XHJcbiAgIH1cclxuXHJcbiAgIHByaXZhdGUgYXV0aFVzZXIoKSB7XHJcbiAgICAgIHRoaXMuYXV0aFNlcnZpY2UubG9naW4odGhpcy5sb2dpbkZvcm0udmFsdWUpLnN1YnNjcmliZShcclxuICAgICAgICAgcmVzcG9uc2UgPT4ge1xyXG4gICAgICAgICAgICBpZiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgdGhpcy50b2tlblBvcnZpZGVyU2VydmljZS5zZXRUb2tlbihyZXNwb25zZSk7XHJcbiAgICAgICAgICAgICAgIHRoaXMubG9naW5DbGljay5lbWl0KHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICB0aGlzLmxvZ2luQ2xpY2suZW1pdChmYWxzZSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9LFxyXG4gICAgICAgICBlcnJvciA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKVxyXG4gICAgICAgICAgICB0aGlzLmxvZ2luQ2xpY2suZW1pdChmYWxzZSlcclxuICAgICAgICAgfVxyXG4gICAgICApXHJcbiAgIH1cclxuXHJcbiAgIHB1YmxpYyBsb2dpbkFEKCkge1xyXG4gICAgICB0aGlzLmlzQWQgPSB0cnVlO1xyXG4gICAgICB0aGlzLm1zYWxTZXJ2aWNlLmxvZ2luUG9wdXAoKS5zdWJzY3JpYmUoKHJlc3BvbnNlOiBBdXRoZW50aWNhdGlvblJlc3VsdCkgPT4ge1xyXG4gICAgICAgICB0aGlzLm1zYWxTZXJ2aWNlLmluc3RhbmNlLnNldEFjdGl2ZUFjY291bnQocmVzcG9uc2UuYWNjb3VudCk7XHJcbiAgICAgICAgIHRoaXMudG9rZW5BZCA9IHJlc3BvbnNlLmFjY2Vzc1Rva2VuO1xyXG4gICAgICAgICB0aGlzLmF1dGhVc2VyQUQodGhpcy50b2tlbkFkKTtcclxuICAgICAgfSwgZXJyb3IgPT4ge1xyXG4gICAgICAgICBjb25zb2xlLmxvZygnRXJyb3I6ICcsIGVycm9yKTtcclxuICAgICAgICAgdGhpcy5sb2dpbkNsaWNrLmVtaXQoZmFsc2UpO1xyXG4gICAgICB9KVxyXG4gICB9XHJcblxyXG4gICBwcml2YXRlIGF1dGhVc2VyQUQodG9rZW46IHN0cmluZykge1xyXG4gICAgICB0aGlzLmF1dGhTZXJ2aWNlQUQubG9naW5BRCh0b2tlbikuc3Vic2NyaWJlKFxyXG4gICAgICAgICByZXNwb25zZSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICB0aGlzLnRva2VuUG9ydmlkZXJTZXJ2aWNlLnNldFRva2VuKHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgICAgdGhpcy5sb2dpbkNsaWNrLmVtaXQodHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgIHRoaXMubG9naW5DbGljay5lbWl0KGZhbHNlKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH0sXHJcbiAgICAgICAgIGVycm9yID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpXHJcbiAgICAgICAgICAgIHRoaXMubG9naW5DbGljay5lbWl0KGZhbHNlKVxyXG4gICAgICAgICB9XHJcbiAgICAgIClcclxuICAgfVxyXG5cclxuICAgcHVibGljIHJlY292ZXJ5UGFzc0VtaXQoKXtcclxuICAgICAgdGhpcy5yZXNldENsaWNrLmVtaXQodHJ1ZSk7XHJcbiAgIH1cclxuXHJcbn1cclxuIiwiPGRpdiBjbGFzcz1cImNvbnRhaW5lclwiPlxyXG4gIDxkaXYgY2xhc3M9XCJyb3cgZm9ybS1jb250ZW50IGp1c3RpZnktY29udGVudC1zdGFydCBhbGlnbi1pdGVtcy1jZW50ZXJcIj5cclxuICAgIDxmb3JtIFtmb3JtR3JvdXBdPVwibG9naW5Gb3JtXCIgPlxyXG4gICAgICA8ZGl2IGNsYXNzPVwiY29sIGNvbC14bC00IGNvbC1sZy04IGNvbC1tZC04IGNvbC0xMlwiPlxyXG4gICAgICAgIDxkaXYgY2xhc3M9XCJjb250YWluZXItZmx1aWRcIj5cclxuICAgICAgICAgIDxkaXYgKm5nSWY9XCJ0eXBlTG9naW4gIT09ICdpbnRlcm5hbCdcIiBjbGFzcz1cInJvd1wiPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29sIGNvbC0xMlwiPlxyXG4gICAgICAgICAgICAgIDxtYXQtbGFiZWw+Q29ycmVvXHJcbiAgICAgICAgICAgICAgPC9tYXQtbGFiZWw+XHJcbiAgICAgICAgICAgICAgPG1hdC1mb3JtLWZpZWxkIFtzdHlsZS5mb250U2l6ZS5weF09XCIxMlwiIGFwcGVhcmFuY2U9XCJvdXRsaW5lXCI+XHJcbiAgICAgICAgICAgICAgICA8bWF0LWxhYmVsPmVqZW1wbG9AY29ycnJlby5jb21cclxuICAgICAgICAgICAgICAgIDwvbWF0LWxhYmVsPlxyXG4gICAgICAgICAgICAgICAgPG1hdC1pY29uIG1hdFN1ZmZpeD5lbWFpbDwvbWF0LWljb24+XHJcbiAgICAgICAgICAgICAgICA8aW5wdXQgXHJcbiAgICAgICAgICAgICAgICAgIG1hdElucHV0IFxyXG4gICAgICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiIFxyXG4gICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cImVqZW1wbG9AY29ycnJlby5jb21cIiBcclxuICAgICAgICAgICAgICAgICAgbWF4bGVuZ3RoPVwiNTBcIiBcclxuICAgICAgICAgICAgICAgICAgZm9ybUNvbnRyb2xOYW1lPVwidXNlck5hbWVcIiBcclxuICAgICAgICAgICAgICAgICAgbmFtZT1cInVzZXJOYW1lXCIgXHJcbiAgICAgICAgICAgICAgICAgIGlkPVwidXNlck5hbWVcIiBcclxuICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ+XHJcbiAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgPG1hdC1lcnJvciAqbmdJZj1cImxvZ2luRm9ybS5nZXQoJ3VzZXJOYW1lJyk/Lmhhc0Vycm9yKCdyZXF1aXJlZCcpICYmIGxvZ2luRm9ybS5nZXQoJ3VzZXJOYW1lJyk/LnRvdWNoZWRcIj5cclxuICAgICAgICAgICAgICAgICAgQ2FtcG8gcmVxdWVyaWRvXHJcbiAgICAgICAgICAgICAgICA8L21hdC1lcnJvcj5cclxuICAgICAgICAgICAgICA8L21hdC1mb3JtLWZpZWxkPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNvbCBjb2wtMTJcIj5cclxuICAgICAgICAgICAgICA8bWF0LWxhYmVsPkNvbnRyYXNlw7FhPC9tYXQtbGFiZWw+XHJcbiAgICAgICAgICAgICAgPG1hdC1mb3JtLWZpZWxkIFtzdHlsZS5mb250U2l6ZS5weF09XCIxMlwiIGFwcGVhcmFuY2U9XCJvdXRsaW5lXCI+XHJcbiAgICAgICAgICAgICAgICA8bWF0LWxhYmVsPmNvbnRyYXNlw7FhPC9tYXQtbGFiZWw+XHJcbiAgICAgICAgICAgICAgICA8bWF0LWljb24gbWF0U3VmZml4PnZwbl9rZXk8L21hdC1pY29uPlxyXG4gICAgICAgICAgICAgICAgPGlucHV0IFxyXG4gICAgICAgICAgICAgICAgICBtYXRJbnB1dCBcclxuICAgICAgICAgICAgICAgICAgdHlwZT1cInBhc3N3b3JkXCIgXHJcbiAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiQ29udHJhc2XDsWFcIiBcclxuICAgICAgICAgICAgICAgICAgbWF4bGVuZ3RoPVwiNTBcIiBcclxuICAgICAgICAgICAgICAgICAgZm9ybUNvbnRyb2xOYW1lPVwicGFzc3dvcmRcIiBcclxuICAgICAgICAgICAgICAgICAgbmFtZT1cInBhc3N3b3JkXCIgXHJcbiAgICAgICAgICAgICAgICAgIGlkPVwicGFzc3dvclwiIFxyXG4gICAgICAgICAgICAgICAgICByZXF1aXJlZD5cclxuICAgICAgICAgICAgICAgIDxtYXQtZXJyb3IgKm5nSWY9XCJsb2dpbkZvcm0uZ2V0KCdwYXNzd29yZCcpPy5oYXNFcnJvcigncmVxdWlyZWQnKSAmJiBsb2dpbkZvcm0uZ2V0KCdwYXNzd29yZCcpPy50b3VjaGVkXCI+XHJcbiAgICAgICAgICAgICAgICAgIENhbXBvIHJlcXVlcmlkb1xyXG4gICAgICAgICAgICAgICAgPC9tYXQtZXJyb3I+XHJcbiAgICAgICAgICAgICAgPC9tYXQtZm9ybS1maWVsZD5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJyb3cgcmVjb3ZlcnktcGFzc1wiPlxyXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjb2wgY29sLTEyXCI+XHJcbiAgICAgICAgICAgICAgICA8YnV0dG9uIG1hdC1idXR0b24gY2xhc3M9XCJidG5fdGVydGlhcnlcIiAoY2xpY2spPVwicmVjb3ZlcnlQYXNzRW1pdCgpXCI+T2x2aWRlIG1pIGNvbnRyYXNlw7FhPC9idXR0b24+XHJcbiAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29sIGNvbC0xMiB0ZXh0LWNlbnRlclwiPlxyXG4gICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJidG5fcHJpbWFyeVwiIChjbGljayk9XCJsb2dpbigpXCI+SW5pY2lhciBzZXNpw7NuPC9idXR0b24+XHJcbiAgICAgICAgICAgIDwvZGl2PiBcclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPGRpdiAqbmdJZj1cInR5cGVMb2dpbiAhPT0gJ2V4dGVybmFsJ1wiIGNsYXNzPVwiY29sIGNvbC0xMiB0ZXh0LWNlbnRlclwiPlxyXG4gICAgICAgICAgICA8YnV0dG9uIG1hdC1idXR0b24gY2xhc3M9XCJidG5fdGVydGlhcnlcIiAoY2xpY2spPVwibG9naW5BRCgpXCI+SW5ncmVzYXIgY29uIEFjdGl2ZSBEaXJlY3Rvcnk8L2J1dHRvbj5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8L2Rpdj5cclxuICAgIDwvZm9ybT4gICBcclxuICA8L2Rpdj5cclxuPC9kaXY+Il19