import { Component, EventEmitter, Inject, Output } from '@angular/core';
import { FormControl, Validators } from '@angular/forms';
import { CONFIGLIBRARY } from '../../config-library.interface';
import * as i0 from "@angular/core";
import * as i1 from "@angular/forms";
import * as i2 from "@angular/router";
import * as i3 from "./services/auth.service";
import * as i4 from "./services/auth-AD.service";
import * as i5 from "./interfaces/token-payload-provider.interface";
import * as i6 from "@angular/material/form-field";
import * as i7 from "@angular/material/icon";
import * as i8 from "@angular/material/button";
import * as i9 from "@angular/common";
import * as i10 from "@angular/material/input";
import * as i11 from "../../config-library.interface";
export class LoginLibraryComponent {
    constructor(configLibrary, fb, activatedRoute, authService, authServiceAD, tokenPorviderService) {
        this.fb = fb;
        this.activatedRoute = activatedRoute;
        this.authService = authService;
        this.authServiceAD = authServiceAD;
        this.tokenPorviderService = tokenPorviderService;
        this.loginClick = new EventEmitter();
        this.resetClick = new EventEmitter();
        this.isAuthenticated = false;
        this.typeLogin = '';
        this.isAd = false;
        this.tokenAd = '';
        this.redirectUri = '';
        this.typeLogin = configLibrary.loginType;
        this.redirectUri = configLibrary.redirectUri;
    }
    ngOnInit() {
        this.loadForm();
        this.typeLogin = this.authService.loginType;
        //this.loadParamsAD();
    }
    loadForm() {
        this.loginForm = this.fb.group({
            userName: new FormControl(null, [Validators.required, Validators.maxLength(50)]),
            password: new FormControl(null, [Validators.required, Validators.maxLength(50)]),
        });
    }
    login() {
        if (this.loginForm.invalid) {
            this.loginClick.emit(false);
        }
        else {
            this.authUser();
        }
    }
    authUser() {
        this.authService.login(this.loginForm.value).subscribe(response => {
            if (response) {
                this.tokenPorviderService.setToken(response);
                this.loginClick.emit(true);
            }
            else {
                this.loginClick.emit(false);
            }
        }, error => {
            console.log(error);
            this.loginClick.emit(false);
        });
    }
    //Login AD
    // public loadParamsAD(){
    //    this.activatedRoute.queryParams.subscribe(params => {
    //       const data: any = params || null;
    //       if (data !== null) {
    //          const paramsRoute = {
    //             "content":{
    //                "token":{
    //                   "accessToken": data.accessToken,
    //                   "refreshToken":data.refreshToken
    //                }
    //             },
    //             "msg":null
    //          }
    //          this.authServiceAD.loginAD(paramsRoute).subscribe(resp => {
    //             this.authUserAD(resp);
    //          },
    //          error => {
    //             console.log(error)
    //             this.loginClick.emit(false)
    //          });
    //       }
    //     });
    // }
    // private authUserAD(response) {
    //    if (response) {
    //       this.tokenPorviderService.setToken(response);
    //       this.loginClick.emit(true);
    //    }
    //    else {
    //       this.loginClick.emit(false)
    //    }
    // }
    loginAD() {
        window.location.href = `${this.redirectUri}`;
    }
    //Reset Password
    recoveryPassEmit() {
        this.resetClick.emit(true);
    }
}
LoginLibraryComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: LoginLibraryComponent, deps: [{ token: CONFIGLIBRARY }, { token: i1.FormBuilder }, { token: i2.ActivatedRoute }, { token: i3.AuthenticationService }, { token: i4.AuthAdService }, { token: i5.TokenPorviderService }], target: i0.ɵɵFactoryTarget.Component });
LoginLibraryComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "12.2.16", type: LoginLibraryComponent, selector: "lib-security-library-login", outputs: { loginClick: "loginClick", resetClick: "resetClick" }, ngImport: i0, template: "<div class=\"container\">\r\n  <div class=\"row form-content justify-content-start align-items-center\">\r\n    <form [formGroup]=\"loginForm\" >\r\n      <div class=\"col col-xl-4 col-lg-8 col-md-8 col-12\">\r\n        <div class=\"container-fluid\">\r\n          <div *ngIf=\"typeLogin !== 'internal'\" class=\"row\">\r\n            <div class=\"col col-12\">\r\n              <mat-label>Correo\r\n              </mat-label>\r\n              <mat-form-field [style.fontSize.px]=\"12\" appearance=\"outline\">\r\n                <mat-label>ejemplo@corrreo.com\r\n                </mat-label>\r\n                <mat-icon matSuffix>email</mat-icon>\r\n                <input \r\n                  matInput \r\n                  type=\"text\" \r\n                  placeholder=\"ejemplo@corrreo.com\" \r\n                  maxlength=\"50\" \r\n                  formControlName=\"userName\" \r\n                  name=\"userName\" \r\n                  id=\"userName\" \r\n                  required>\r\n                  \r\n                <mat-error *ngIf=\"loginForm.get('userName')?.hasError('required') && loginForm.get('userName')?.touched\">\r\n                  Campo requerido\r\n                </mat-error>\r\n              </mat-form-field>\r\n            </div>\r\n            <div class=\"col col-12\">\r\n              <mat-label>Contrase\u00F1a</mat-label>\r\n              <mat-form-field [style.fontSize.px]=\"12\" appearance=\"outline\">\r\n                <mat-label>contrase\u00F1a</mat-label>\r\n                <mat-icon matSuffix>vpn_key</mat-icon>\r\n                <input \r\n                  matInput \r\n                  type=\"password\" \r\n                  placeholder=\"Contrase\u00F1a\" \r\n                  maxlength=\"50\" \r\n                  formControlName=\"password\" \r\n                  name=\"password\" \r\n                  id=\"passwor\" \r\n                  required>\r\n                <mat-error *ngIf=\"loginForm.get('password')?.hasError('required') && loginForm.get('password')?.touched\">\r\n                  Campo requerido\r\n                </mat-error>\r\n              </mat-form-field>\r\n            </div>\r\n            <div class=\"row recovery-pass\">\r\n              <div class=\"col col-12\">\r\n                <button mat-button class=\"btn_tertiary\" (click)=\"recoveryPassEmit()\">Olvide mi contrase\u00F1a</button>\r\n              </div>\r\n            </div>\r\n            <div class=\"col col-12 text-center\">\r\n              <button class=\"btn_primary\" (click)=\"login()\">Iniciar sesi\u00F3n</button>\r\n            </div> \r\n          </div>\r\n          <div *ngIf=\"typeLogin !== 'external'\" class=\"col col-12 text-center\">\r\n            <button mat-button class=\"btn_tertiary\" (click)=\"loginAD()\">Ingresar con Active Directory</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </form>   \r\n  </div>\r\n</div>", styles: [".btn_primary{color:#f8f9fb;text-transform:initial;text-align:center;background-color:#214eb7;text-decoration:none;border:0;border-radius:8px;cursor:pointer;letter-spacing:1.5px;width:100%!important;height:40px;padding:10px 8px;font-size:14px;font-weight:400}.btn_primary:hover{background-color:#01818f}.btn_primary:disabled{color:#828282;background-color:#b0b0b0;pointer-events:none}.btn_secondary{color:#01818f;text-transform:initial;text-align:center;background-color:#ecfafc;text-decoration:none;border:1px solid #0095A8;border-radius:8px;cursor:pointer;letter-spacing:1.5px;width:150px!important;height:40px;padding:10px 8px;font-size:14px;font-weight:400}.btn_secondary:hover{background-color:#b2eaf333}.btn_secondary:disabled{color:#b0b0b0;background-color:#e9e9e9;border:1px solid #e9e9e9;pointer-events:none}.btn_tertiary{color:#214eb7}.bg_breadcrumb{background:url(/assets/img/bg_breadcrumb.png) no-repeat;background-color:#005db4;background-size:contain;height:72px;padding-left:30px}.bg_breadcrumb .breadcrumb{color:#fff;margin:0;padding:0;font-style:normal;font-weight:600;letter-spacing:.02em;text-transform:capitalize;vertical-align:middle;line-height:58px}.bg_breadcrumb .breadcrumb span{font-size:18px;color:#bcd}.bg_breadcrumb .breadcrumb span:hover{color:#01818f;text-decoration:none}.bg_breadcrumb .breadcrumb li{list-style:none;float:left;margin:5px}.bg_breadcrumb .breadcrumb li:last-child{margin-right:5px}.bg_breadcrumb .breadcrumb li:after{content:\" > \";color:#fff}.bg_breadcrumb .breadcrumb li:last-child:after{content:\"\"}h1{font-size:34px;font-weight:500}h2{font-size:24px;font-weight:500}h3{font-size:20px;font-weight:500}h4{font-size:18px;font-weight:400}h5{font-style:normal!important;font-weight:500!important;font-size:12px!important;line-height:18px!important;letter-spacing:.15px!important;color:#3f4b6c!important}a{color:#118584}.swal2-styled.swal2-confirm{background-color:#0095a8!important}.swal2-styled.swal2-confirm:focus{box-shadow:none!important}.bg_evidence{background:rgba(249,249,249,.55);border:.5px solid #eceff2;box-sizing:border-box;height:261px;padding-left:25px;margin-left:25px;margin-right:25px}.date_evidence{font-style:normal;font-weight:500;font-size:12px;line-height:18px;text-align:center;letter-spacing:.155002px;color:#7792ac}.rb_evidence{display:flex;flex-direction:column;margin:15px 0;width:150px}.container_evidence{margin:4px,4px;padding:4px;overflow-x:auto;overflow-y:hidden;white-space:nowrap;width:100%}.card_evidence{width:170px;text-align:center}.lbl_evidence{font-style:normal;font-weight:500;font-size:12px;line-height:18px;letter-spacing:.15px;color:#3f4b6c}.mat-form-field-no-padding .mat-form-field-wrapper{margin-top:-.5em}.mobile-label{display:none}.mobile-cantidad>input{width:80%}@media (max-width: 600px){.mobile-label{width:130px;display:inline-block;font-weight:bold}.mat-header-row{display:none}.mat-row{flex-direction:column;align-items:start;text-align:left;padding:8px 24px}.mat-cell:first-of-type{padding:5px 10px!important}.mobile-cantidad{width:150px}}.container .form-content .title{font-family:var(--font-poppins-bold);font-style:normal;font-weight:500;font-size:26px;line-height:39px;text-transform:uppercase;color:#9399b2}.container mat-form-field.mat-form-field{width:100%;font-size:16px;color:#9399b2}.container mat-label{font-family:var(--font-roboto);font-style:normal;font-weight:700;font-size:14px;line-height:14px;letter-spacing:.15px;color:#656d8e}.text-center{display:grid}.recovery-pass{text-align:right}.login_title{font-family:\"Poppins\",\"Roboto\",sans-serif;font-style:normal;font-weight:500;font-size:26px;line-height:39px;text-transform:uppercase;color:#f8f9fb}.login_label{font-family:\"Roboto\",sans-serif;font-style:normal;font-weight:bold;font-size:12px;line-height:14px;letter-spacing:.15px;color:#f8f9fb}input::placeholder{font-family:\"Roboto\",sans-serif;font-style:normal;font-weight:500;font-size:14px;line-height:16px;letter-spacing:.15px;color:#9eb7cc}input:-webkit-autofill,input:-webkit-autofill:hover,input:-webkit-autofill:focus,input:-webkit-autofill:active{-webkit-transition:background-color 5000s;transition:background-color 5000s;-webkit-text-fill-color:#656D8E!important}\n"], components: [{ type: i6.MatFormField, selector: "mat-form-field", inputs: ["color", "floatLabel", "appearance", "hideRequiredMarker", "hintLabel"], exportAs: ["matFormField"] }, { type: i7.MatIcon, selector: "mat-icon", inputs: ["color", "inline", "svgIcon", "fontSet", "fontIcon"], exportAs: ["matIcon"] }, { type: i8.MatButton, selector: "button[mat-button], button[mat-raised-button], button[mat-icon-button],             button[mat-fab], button[mat-mini-fab], button[mat-stroked-button],             button[mat-flat-button]", inputs: ["disabled", "disableRipple", "color"], exportAs: ["matButton"] }], directives: [{ type: i1.ɵNgNoValidate, selector: "form:not([ngNoForm]):not([ngNativeValidate])" }, { type: i1.NgControlStatusGroup, selector: "[formGroupName],[formArrayName],[ngModelGroup],[formGroup],form:not([ngNoForm]),[ngForm]" }, { type: i1.FormGroupDirective, selector: "[formGroup]", inputs: ["formGroup"], outputs: ["ngSubmit"], exportAs: ["ngForm"] }, { type: i9.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { type: i6.MatLabel, selector: "mat-label" }, { type: i6.MatSuffix, selector: "[matSuffix]" }, { type: i10.MatInput, selector: "input[matInput], textarea[matInput], select[matNativeControl],      input[matNativeControl], textarea[matNativeControl]", inputs: ["id", "disabled", "required", "type", "value", "readonly", "placeholder", "errorStateMatcher", "aria-describedby"], exportAs: ["matInput"] }, { type: i1.DefaultValueAccessor, selector: "input:not([type=checkbox])[formControlName],textarea[formControlName],input:not([type=checkbox])[formControl],textarea[formControl],input:not([type=checkbox])[ngModel],textarea[ngModel],[ngDefaultControl]" }, { type: i1.MaxLengthValidator, selector: "[maxlength][formControlName],[maxlength][formControl],[maxlength][ngModel]", inputs: ["maxlength"] }, { type: i1.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { type: i1.FormControlName, selector: "[formControlName]", inputs: ["disabled", "formControlName", "ngModel"], outputs: ["ngModelChange"] }, { type: i1.RequiredValidator, selector: ":not([type=checkbox])[required][formControlName],:not([type=checkbox])[required][formControl],:not([type=checkbox])[required][ngModel]", inputs: ["required"] }, { type: i6.MatError, selector: "mat-error", inputs: ["id"] }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: LoginLibraryComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'lib-security-library-login',
                    templateUrl: './login-library.component.html',
                    styleUrls: ['./login-library.component.scss']
                }]
        }], ctorParameters: function () { return [{ type: i11.IConfigLibrary, decorators: [{
                    type: Inject,
                    args: [CONFIGLIBRARY]
                }] }, { type: i1.FormBuilder }, { type: i2.ActivatedRoute }, { type: i3.AuthenticationService }, { type: i4.AuthAdService }, { type: i5.TokenPorviderService }]; }, propDecorators: { loginClick: [{
                type: Output
            }], resetClick: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9naW4tbGlicmFyeS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9zZWN1cml0eS1saWJyYXJ5L3NyYy9saWIvbG9naW4vbG9naW4tbGlicmFyeS5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9zZWN1cml0eS1saWJyYXJ5L3NyYy9saWIvbG9naW4vbG9naW4tbGlicmFyeS5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLFlBQVksRUFBRSxNQUFNLEVBQVUsTUFBTSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ2hGLE9BQU8sRUFBZSxXQUFXLEVBQWEsVUFBVSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFLakYsT0FBTyxFQUFFLGFBQWEsRUFBa0IsTUFBTSxnQ0FBZ0MsQ0FBQzs7Ozs7Ozs7Ozs7OztBQU8vRSxNQUFNLE9BQU8scUJBQXFCO0lBVy9CLFlBQzBCLGFBQTZCLEVBQzVDLEVBQWUsRUFDZixjQUE4QixFQUM5QixXQUFrQyxFQUNsQyxhQUE0QixFQUM1QixvQkFBMEM7UUFKMUMsT0FBRSxHQUFGLEVBQUUsQ0FBYTtRQUNmLG1CQUFjLEdBQWQsY0FBYyxDQUFnQjtRQUM5QixnQkFBVyxHQUFYLFdBQVcsQ0FBdUI7UUFDbEMsa0JBQWEsR0FBYixhQUFhLENBQWU7UUFDNUIseUJBQW9CLEdBQXBCLG9CQUFvQixDQUFzQjtRQWhCM0MsZUFBVSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFDaEMsZUFBVSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFHbkMsb0JBQWUsR0FBRyxLQUFLLENBQUM7UUFDeEIsY0FBUyxHQUFXLEVBQUUsQ0FBQztRQUM5QixTQUFJLEdBQVksS0FBSyxDQUFDO1FBQ3RCLFlBQU8sR0FBVyxFQUFFLENBQUM7UUFDckIsZ0JBQVcsR0FBVyxFQUFFLENBQUM7UUFVdEIs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LDRCQUE0QjtvQkFDdEMsV0FBVyxFQUFFLGdDQUFnQztvQkFDN0MsU0FBUyxFQUFFLENBQUMsZ0NBQWdDLENBQUM7aUJBQy9DOzswQkFhTSxNQUFNOzJCQUFDLGFBQWE7c01BWGQsVUFBVTtzQkFBbkIsTUFBTTtnQkFDRyxVQUFVO3NCQUFuQixNQUFNIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBFdmVudEVtaXR0ZXIsIEluamVjdCwgT25Jbml0LCBPdXRwdXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgRm9ybUJ1aWxkZXIsIEZvcm1Db250cm9sLCBGb3JtR3JvdXAsIFZhbGlkYXRvcnMgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XHJcblxyXG5pbXBvcnQgeyBBdXRoZW50aWNhdGlvblNlcnZpY2UgfSBmcm9tICcuL3NlcnZpY2VzL2F1dGguc2VydmljZSc7XHJcbmltcG9ydCB7IFRva2VuUG9ydmlkZXJTZXJ2aWNlIH0gZnJvbSAnLi9pbnRlcmZhY2VzL3Rva2VuLXBheWxvYWQtcHJvdmlkZXIuaW50ZXJmYWNlJztcclxuaW1wb3J0IHsgQXV0aEFkU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvYXV0aC1BRC5zZXJ2aWNlJztcclxuaW1wb3J0IHsgQ09ORklHTElCUkFSWSwgSUNvbmZpZ0xpYnJhcnkgfSBmcm9tICcuLi8uLi9jb25maWctbGlicmFyeS5pbnRlcmZhY2UnO1xyXG5pbXBvcnQgeyBBY3RpdmF0ZWRSb3V0ZSB9IGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XHJcbkBDb21wb25lbnQoe1xyXG4gICBzZWxlY3RvcjogJ2xpYi1zZWN1cml0eS1saWJyYXJ5LWxvZ2luJyxcclxuICAgdGVtcGxhdGVVcmw6ICcuL2xvZ2luLWxpYnJhcnkuY29tcG9uZW50Lmh0bWwnLFxyXG4gICBzdHlsZVVybHM6IFsnLi9sb2dpbi1saWJyYXJ5LmNvbXBvbmVudC5zY3NzJ11cclxufSlcclxuZXhwb3J0IGNsYXNzIExvZ2luTGlicmFyeUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcbiAgIEBPdXRwdXQoKSBsb2dpbkNsaWNrID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICBAT3V0cHV0KCkgcmVzZXRDbGljayA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgIHB1YmxpYyBsb2dpbkZvcm0hOiBGb3JtR3JvdXA7XHJcbiAgIHB1YmxpYyBpc0F1dGhlbnRpY2F0ZWQgPSBmYWxzZTtcclxuICAgcHVibGljIHR5cGVMb2dpbjogc3RyaW5nID0gJyc7XHJcbiAgIGlzQWQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgdG9rZW5BZDogc3RyaW5nID0gJyc7XHJcbiAgIHJlZGlyZWN0VXJpOiBzdHJpbmcgPSAnJztcclxuXHJcbiAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICBASW5qZWN0KENPTkZJR0xJQlJBUlkpIGNvbmZpZ0xpYnJhcnk6IElDb25maWdMaWJyYXJ5LFxyXG4gICAgICBwcml2YXRlIGZiOiBGb3JtQnVpbGRlcixcclxuICAgICAgcHJpdmF0ZSBhY3RpdmF0ZWRSb3V0ZTogQWN0aXZhdGVkUm91dGUsXHJcbiAgICAgIHByaXZhdGUgYXV0aFNlcnZpY2U6IEF1dGhlbnRpY2F0aW9uU2VydmljZSxcclxuICAgICAgcHJpdmF0ZSBhdXRoU2VydmljZUFEOiBBdXRoQWRTZXJ2aWNlLFxyXG4gICAgICBwcml2YXRlIHRva2VuUG9ydmlkZXJTZXJ2aWNlOiBUb2tlblBvcnZpZGVyU2VydmljZVxyXG4gICApIHtcclxuICAgICAgdGhpcy50eXBlTG9naW4gPSBjb25maWdMaWJyYXJ5LmxvZ2luVHlwZTtcclxuICAgICAgdGhpcy5yZWRpcmVjdFVyaSA9IGNvbmZpZ0xpYnJhcnkucmVkaXJlY3RVcmk7XHJcbiAgICB9XHJcblxyXG4gICBwdWJsaWMgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICAgIHRoaXMubG9hZEZvcm0oKTtcclxuICAgICAgdGhpcy50eXBlTG9naW4gPSB0aGlzLmF1dGhTZXJ2aWNlLmxvZ2luVHlwZTtcclxuICAgICAgLy90aGlzLmxvYWRQYXJhbXNBRCgpO1xyXG4gICB9XHJcblxyXG4gICBwcml2YXRlIGxvYWRGb3JtKCkge1xyXG4gICAgICB0aGlzLmxvZ2luRm9ybSA9IHRoaXMuZmIuZ3JvdXAoe1xyXG4gICAgICAgICB1c2VyTmFtZTogbmV3IEZvcm1Db250cm9sKG51bGwsIFtWYWxpZGF0b3JzLnJlcXVpcmVkLCBWYWxpZGF0b3JzLm1heExlbmd0aCg1MCldKSxcclxuICAgICAgICAgcGFzc3dvcmQ6IG5ldyBGb3JtQ29udHJvbChudWxsLCBbVmFsaWRhdG9ycy5yZXF1aXJlZCwgVmFsaWRhdG9ycy5tYXhMZW5ndGgoNTApXSksXHJcbiAgICAgIH0pXHJcbiAgIH1cclxuXHJcbiAgIHB1YmxpYyBsb2dpbigpIHtcclxuICAgICAgaWYgKHRoaXMubG9naW5Gb3JtLmludmFsaWQpIHtcclxuICAgICAgICAgdGhpcy5sb2dpbkNsaWNrLmVtaXQoZmFsc2UpXHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHRoaXMuYXV0aFVzZXIoKTtcclxuICAgICAgfVxyXG4gICB9XHJcblxyXG4gICBwcml2YXRlIGF1dGhVc2VyKCkge1xyXG4gICAgICB0aGlzLmF1dGhTZXJ2aWNlLmxvZ2luKHRoaXMubG9naW5Gb3JtLnZhbHVlKS5zdWJzY3JpYmUoXHJcbiAgICAgICAgIHJlc3BvbnNlID0+IHtcclxuICAgICAgICAgICAgaWYgKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgIHRoaXMudG9rZW5Qb3J2aWRlclNlcnZpY2Uuc2V0VG9rZW4ocmVzcG9uc2UpO1xyXG4gICAgICAgICAgICAgICB0aGlzLmxvZ2luQ2xpY2suZW1pdCh0cnVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgdGhpcy5sb2dpbkNsaWNrLmVtaXQoZmFsc2UpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfSxcclxuICAgICAgICAgZXJyb3IgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcilcclxuICAgICAgICAgICAgdGhpcy5sb2dpbkNsaWNrLmVtaXQoZmFsc2UpXHJcbiAgICAgICAgIH1cclxuICAgICAgKVxyXG4gICB9XHJcblxyXG4gICAvL0xvZ2luIEFEXHJcbiAgIC8vIHB1YmxpYyBsb2FkUGFyYW1zQUQoKXtcclxuICAgLy8gICAgdGhpcy5hY3RpdmF0ZWRSb3V0ZS5xdWVyeVBhcmFtcy5zdWJzY3JpYmUocGFyYW1zID0+IHtcclxuICAgLy8gICAgICAgY29uc3QgZGF0YTogYW55ID0gcGFyYW1zIHx8IG51bGw7XHJcbiAgIC8vICAgICAgIGlmIChkYXRhICE9PSBudWxsKSB7XHJcbiAgIC8vICAgICAgICAgIGNvbnN0IHBhcmFtc1JvdXRlID0ge1xyXG4gICAvLyAgICAgICAgICAgICBcImNvbnRlbnRcIjp7XHJcbiAgIC8vICAgICAgICAgICAgICAgIFwidG9rZW5cIjp7XHJcbiAgIC8vICAgICAgICAgICAgICAgICAgIFwiYWNjZXNzVG9rZW5cIjogZGF0YS5hY2Nlc3NUb2tlbixcclxuICAgLy8gICAgICAgICAgICAgICAgICAgXCJyZWZyZXNoVG9rZW5cIjpkYXRhLnJlZnJlc2hUb2tlblxyXG4gICAvLyAgICAgICAgICAgICAgICB9XHJcbiAgIC8vICAgICAgICAgICAgIH0sXHJcbiAgIC8vICAgICAgICAgICAgIFwibXNnXCI6bnVsbFxyXG4gICAvLyAgICAgICAgICB9XHJcbiAgIC8vICAgICAgICAgIHRoaXMuYXV0aFNlcnZpY2VBRC5sb2dpbkFEKHBhcmFtc1JvdXRlKS5zdWJzY3JpYmUocmVzcCA9PiB7XHJcbiAgIC8vICAgICAgICAgICAgIHRoaXMuYXV0aFVzZXJBRChyZXNwKTtcclxuICAgLy8gICAgICAgICAgfSxcclxuICAgLy8gICAgICAgICAgZXJyb3IgPT4ge1xyXG4gICAvLyAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcilcclxuICAgLy8gICAgICAgICAgICAgdGhpcy5sb2dpbkNsaWNrLmVtaXQoZmFsc2UpXHJcbiAgIC8vICAgICAgICAgIH0pO1xyXG4gICAvLyAgICAgICB9XHJcbiAgIC8vICAgICB9KTtcclxuICAgLy8gfVxyXG5cclxuICAgLy8gcHJpdmF0ZSBhdXRoVXNlckFEKHJlc3BvbnNlKSB7XHJcbiAgIC8vICAgIGlmIChyZXNwb25zZSkge1xyXG4gICAvLyAgICAgICB0aGlzLnRva2VuUG9ydmlkZXJTZXJ2aWNlLnNldFRva2VuKHJlc3BvbnNlKTtcclxuICAgLy8gICAgICAgdGhpcy5sb2dpbkNsaWNrLmVtaXQodHJ1ZSk7XHJcbiAgIC8vICAgIH1cclxuICAgLy8gICAgZWxzZSB7XHJcbiAgIC8vICAgICAgIHRoaXMubG9naW5DbGljay5lbWl0KGZhbHNlKVxyXG4gICAvLyAgICB9XHJcblxyXG4gICAvLyB9XHJcblxyXG4gICBwdWJsaWMgbG9naW5BRCgpIHtcclxuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWY9YCR7dGhpcy5yZWRpcmVjdFVyaX1gO1xyXG4gICB9XHJcblxyXG4gICAvL1Jlc2V0IFBhc3N3b3JkXHJcbiAgIHB1YmxpYyByZWNvdmVyeVBhc3NFbWl0KCl7XHJcbiAgICAgIHRoaXMucmVzZXRDbGljay5lbWl0KHRydWUpO1xyXG4gICB9XHJcblxyXG59XHJcbiIsIjxkaXYgY2xhc3M9XCJjb250YWluZXJcIj5cclxuICA8ZGl2IGNsYXNzPVwicm93IGZvcm0tY29udGVudCBqdXN0aWZ5LWNvbnRlbnQtc3RhcnQgYWxpZ24taXRlbXMtY2VudGVyXCI+XHJcbiAgICA8Zm9ybSBbZm9ybUdyb3VwXT1cImxvZ2luRm9ybVwiID5cclxuICAgICAgPGRpdiBjbGFzcz1cImNvbCBjb2wteGwtNCBjb2wtbGctOCBjb2wtbWQtOCBjb2wtMTJcIj5cclxuICAgICAgICA8ZGl2IGNsYXNzPVwiY29udGFpbmVyLWZsdWlkXCI+XHJcbiAgICAgICAgICA8ZGl2ICpuZ0lmPVwidHlwZUxvZ2luICE9PSAnaW50ZXJuYWwnXCIgY2xhc3M9XCJyb3dcIj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNvbCBjb2wtMTJcIj5cclxuICAgICAgICAgICAgICA8bWF0LWxhYmVsPkNvcnJlb1xyXG4gICAgICAgICAgICAgIDwvbWF0LWxhYmVsPlxyXG4gICAgICAgICAgICAgIDxtYXQtZm9ybS1maWVsZCBbc3R5bGUuZm9udFNpemUucHhdPVwiMTJcIiBhcHBlYXJhbmNlPVwib3V0bGluZVwiPlxyXG4gICAgICAgICAgICAgICAgPG1hdC1sYWJlbD5lamVtcGxvQGNvcnJyZW8uY29tXHJcbiAgICAgICAgICAgICAgICA8L21hdC1sYWJlbD5cclxuICAgICAgICAgICAgICAgIDxtYXQtaWNvbiBtYXRTdWZmaXg+ZW1haWw8L21hdC1pY29uPlxyXG4gICAgICAgICAgICAgICAgPGlucHV0IFxyXG4gICAgICAgICAgICAgICAgICBtYXRJbnB1dCBcclxuICAgICAgICAgICAgICAgICAgdHlwZT1cInRleHRcIiBcclxuICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJlamVtcGxvQGNvcnJyZW8uY29tXCIgXHJcbiAgICAgICAgICAgICAgICAgIG1heGxlbmd0aD1cIjUwXCIgXHJcbiAgICAgICAgICAgICAgICAgIGZvcm1Db250cm9sTmFtZT1cInVzZXJOYW1lXCIgXHJcbiAgICAgICAgICAgICAgICAgIG5hbWU9XCJ1c2VyTmFtZVwiIFxyXG4gICAgICAgICAgICAgICAgICBpZD1cInVzZXJOYW1lXCIgXHJcbiAgICAgICAgICAgICAgICAgIHJlcXVpcmVkPlxyXG4gICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIDxtYXQtZXJyb3IgKm5nSWY9XCJsb2dpbkZvcm0uZ2V0KCd1c2VyTmFtZScpPy5oYXNFcnJvcigncmVxdWlyZWQnKSAmJiBsb2dpbkZvcm0uZ2V0KCd1c2VyTmFtZScpPy50b3VjaGVkXCI+XHJcbiAgICAgICAgICAgICAgICAgIENhbXBvIHJlcXVlcmlkb1xyXG4gICAgICAgICAgICAgICAgPC9tYXQtZXJyb3I+XHJcbiAgICAgICAgICAgICAgPC9tYXQtZm9ybS1maWVsZD5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjb2wgY29sLTEyXCI+XHJcbiAgICAgICAgICAgICAgPG1hdC1sYWJlbD5Db250cmFzZcOxYTwvbWF0LWxhYmVsPlxyXG4gICAgICAgICAgICAgIDxtYXQtZm9ybS1maWVsZCBbc3R5bGUuZm9udFNpemUucHhdPVwiMTJcIiBhcHBlYXJhbmNlPVwib3V0bGluZVwiPlxyXG4gICAgICAgICAgICAgICAgPG1hdC1sYWJlbD5jb250cmFzZcOxYTwvbWF0LWxhYmVsPlxyXG4gICAgICAgICAgICAgICAgPG1hdC1pY29uIG1hdFN1ZmZpeD52cG5fa2V5PC9tYXQtaWNvbj5cclxuICAgICAgICAgICAgICAgIDxpbnB1dCBcclxuICAgICAgICAgICAgICAgICAgbWF0SW5wdXQgXHJcbiAgICAgICAgICAgICAgICAgIHR5cGU9XCJwYXNzd29yZFwiIFxyXG4gICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIkNvbnRyYXNlw7FhXCIgXHJcbiAgICAgICAgICAgICAgICAgIG1heGxlbmd0aD1cIjUwXCIgXHJcbiAgICAgICAgICAgICAgICAgIGZvcm1Db250cm9sTmFtZT1cInBhc3N3b3JkXCIgXHJcbiAgICAgICAgICAgICAgICAgIG5hbWU9XCJwYXNzd29yZFwiIFxyXG4gICAgICAgICAgICAgICAgICBpZD1cInBhc3N3b3JcIiBcclxuICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ+XHJcbiAgICAgICAgICAgICAgICA8bWF0LWVycm9yICpuZ0lmPVwibG9naW5Gb3JtLmdldCgncGFzc3dvcmQnKT8uaGFzRXJyb3IoJ3JlcXVpcmVkJykgJiYgbG9naW5Gb3JtLmdldCgncGFzc3dvcmQnKT8udG91Y2hlZFwiPlxyXG4gICAgICAgICAgICAgICAgICBDYW1wbyByZXF1ZXJpZG9cclxuICAgICAgICAgICAgICAgIDwvbWF0LWVycm9yPlxyXG4gICAgICAgICAgICAgIDwvbWF0LWZvcm0tZmllbGQ+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwicm93IHJlY292ZXJ5LXBhc3NcIj5cclxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29sIGNvbC0xMlwiPlxyXG4gICAgICAgICAgICAgICAgPGJ1dHRvbiBtYXQtYnV0dG9uIGNsYXNzPVwiYnRuX3RlcnRpYXJ5XCIgKGNsaWNrKT1cInJlY292ZXJ5UGFzc0VtaXQoKVwiPk9sdmlkZSBtaSBjb250cmFzZcOxYTwvYnV0dG9uPlxyXG4gICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNvbCBjb2wtMTIgdGV4dC1jZW50ZXJcIj5cclxuICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwiYnRuX3ByaW1hcnlcIiAoY2xpY2spPVwibG9naW4oKVwiPkluaWNpYXIgc2VzacOzbjwvYnV0dG9uPlxyXG4gICAgICAgICAgICA8L2Rpdj4gXHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIDxkaXYgKm5nSWY9XCJ0eXBlTG9naW4gIT09ICdleHRlcm5hbCdcIiBjbGFzcz1cImNvbCBjb2wtMTIgdGV4dC1jZW50ZXJcIj5cclxuICAgICAgICAgICAgPGJ1dHRvbiBtYXQtYnV0dG9uIGNsYXNzPVwiYnRuX3RlcnRpYXJ5XCIgKGNsaWNrKT1cImxvZ2luQUQoKVwiPkluZ3Jlc2FyIGNvbiBBY3RpdmUgRGlyZWN0b3J5PC9idXR0b24+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Zvcm0+ICAgXHJcbiAgPC9kaXY+XHJcbjwvZGl2PiJdfQ==